<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>CleanBite - Report Issue</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#A0D9B5",
                        "primary-dark": "#8bc4a0",
                        "background-light": "#F8FAF9",
                        "background-dark": "#0F1411",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    boxShadow: {
                        'soft': '0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05)',
                        'hover': '0 20px 25px -5px rgba(160, 217, 181, 0.2), 0 10px 10px -6px rgba(160, 217, 181, 0.1)',
                    }
                },
            },
        }
    </script>
<style type="text/tailwindcss">
        @layer components {
            .category-card input:checked + div {
                @apply border-primary bg-primary/10 scale-[1.02] shadow-hover;
            }
            .category-card input:checked + div span {
                @apply text-primary font-bold;
                font-variation-settings: 'FILL' 1;
            }
            .material-symbols-outlined {
                font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            }
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-100 transition-colors duration-200">
<header class="flex items-center justify-between border-b border-slate-200 dark:border-zinc-800 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-md px-6 py-4 sticky top-0 z-50">
<div class="flex items-center gap-4">
<button onclick="history.back()" class="flex items-center gap-2 text-slate-500 hover:text-slate-900 dark:hover:text-white transition-colors">
<span class="material-symbols-outlined">arrow_back</span>
<span class="font-medium">Back</span>
</button>
<div onclick="window.location.href='homepage.html'" class="flex items-center gap-2 cursor-pointer">
<img src="Screenshot 2025-11-27 160334.png" alt="CleanBite Logo" class="size-8 rounded-lg object-cover">
<h2 class="text-2xl font-black tracking-tight text-slate-900 dark:text-white">CleanBite</h2>
</div>
<div class="flex flex-1 justify-end gap-10 items-center">
<nav class="hidden lg:flex items-center gap-8">
</nav>
<div class="flex items-center gap-4">
<div onclick="window.location.href='profile.html'" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-primary/30 ring-4 ring-primary/5 cursor-pointer" style='background-image: url("profilepic.jpeg");'></div>
</div>
</div>
</header>
<main class="max-w-[1000px] mx-auto px-6 py-16">
<div class="mb-14 text-center">
<span class="inline-block px-4 py-1.5 rounded-full bg-primary/10 text-primary-dark font-bold text-sm mb-4">Real-time Hygiene Reporting</span>
<h1 class="text-4xl md:text-6xl font-black leading-[1.1] tracking-tight mb-6 text-slate-900 dark:text-white">Help keep street food safe</h1>
<p class="text-slate-500 dark:text-zinc-400 text-lg md:text-xl max-w-[700px] mx-auto leading-relaxed">
            Spotted a hygiene issue? Report it instantly to help improve community safety and vendor standards.
        </p>
</div>
<form class="space-y-16">
<section class="bg-white dark:bg-zinc-900 p-8 rounded-3xl shadow-soft border border-slate-100 dark:border-zinc-800">
<div class="flex items-center gap-3 mb-6">
<div class="size-10 rounded-xl bg-primary/20 flex items-center justify-center">
<span class="material-symbols-outlined text-primary-dark">storefront</span>
</div>
<h3 class="text-2xl font-extrabold tracking-tight">Which vendor is this?</h3>
</div>
<div class="relative max-w-2xl">
<select name="vendor" class="form-input block w-full rounded-2xl border-slate-200 dark:border-zinc-700 bg-slate-50 dark:bg-zinc-800 focus:ring-4 focus:ring-primary/20 focus:border-primary h-16 px-6 text-lg transition-all appearance-none cursor-pointer" required>
<option value="">Select or search vendor name...</option>
<option value="1">Sunrise Tacos - 5th Ave</option>
<option value="2">Halal Guys Express - Broadway</option>
<option value="3">The Waffle Stand - Park Lane</option>
</select>
<div class="absolute right-6 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
<span class="material-symbols-outlined">expand_more</span>
</div>
</div>
</section>
<section>
<div class="flex items-center gap-3 mb-8">
<div class="size-10 rounded-xl bg-primary/20 flex items-center justify-center">
<span class="material-symbols-outlined text-primary-dark">report_problem</span>
</div>
<h3 class="text-2xl font-extrabold tracking-tight">What's the issue?</h3>
</div>
<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-5">
<label class="category-card cursor-pointer group">
<input class="hidden" name="issue" value="food-uncovered" required="" type="radio"/>
<div class="flex flex-col items-center justify-center p-6 bg-white dark:bg-zinc-900 border-2 border-slate-100 dark:border-zinc-800 rounded-3xl group-hover:border-primary/50 group-hover:shadow-soft group-hover:scale-[1.02] transition-all duration-300 aspect-square">
<span class="material-symbols-outlined text-4xl mb-4 text-slate-400 dark:text-zinc-500 group-hover:text-primary transition-colors">fastfood</span>
<span class="text-sm font-bold text-center leading-tight">Food Uncovered</span>
</div>
</label>
<label class="category-card cursor-pointer group">
<input class="hidden" name="issue" value="dirty-surfaces" type="radio"/>
<div class="flex flex-col items-center justify-center p-6 bg-white dark:bg-zinc-900 border-2 border-slate-100 dark:border-zinc-800 rounded-3xl group-hover:border-primary/50 group-hover:shadow-soft group-hover:scale-[1.02] transition-all duration-300 aspect-square">
<span class="material-symbols-outlined text-4xl mb-4 text-slate-400 dark:text-zinc-500 group-hover:text-primary transition-colors">cleaning_services</span>
<span class="text-sm font-bold text-center leading-tight">Dirty Surfaces</span>
</div>
</label>
<label class="category-card cursor-pointer group">
<input class="hidden" name="issue" value="water-quality" type="radio"/>
<div class="flex flex-col items-center justify-center p-6 bg-white dark:bg-zinc-900 border-2 border-slate-100 dark:border-zinc-800 rounded-3xl group-hover:border-primary/50 group-hover:shadow-soft group-hover:scale-[1.02] transition-all duration-300 aspect-square">
<span class="material-symbols-outlined text-4xl mb-4 text-slate-400 dark:text-zinc-500 group-hover:text-primary transition-colors">water_drop</span>
<span class="text-sm font-bold text-center leading-tight">Water Quality</span>
</div>
</label>
<label class="category-card cursor-pointer group">
<input class="hidden" name="issue" value="no-gloves" type="radio"/>
<div class="flex flex-col items-center justify-center p-6 bg-white dark:bg-zinc-900 border-2 border-slate-100 dark:border-zinc-800 rounded-3xl group-hover:border-primary/50 group-hover:shadow-soft group-hover:scale-[1.02] transition-all duration-300 aspect-square">
<span class="material-symbols-outlined text-4xl mb-4 text-slate-400 dark:text-zinc-500 group-hover:text-primary transition-colors">back_hand</span>
<span class="text-sm font-bold text-center leading-tight">No Gloves/Cap</span>
</div>
</label>
<label class="category-card cursor-pointer group">
<input class="hidden" name="issue" value="waste-disposal" type="radio"/>
<div class="flex flex-col items-center justify-center p-6 bg-white dark:bg-zinc-900 border-2 border-slate-100 dark:border-zinc-800 rounded-3xl group-hover:border-primary/50 group-hover:shadow-soft group-hover:scale-[1.02] transition-all duration-300 aspect-square">
<span class="material-symbols-outlined text-4xl mb-4 text-slate-400 dark:text-zinc-500 group-hover:text-primary transition-colors">delete_forever</span>
<span class="text-sm font-bold text-center leading-tight">Waste Disposal</span>
</div>
</label>
</div>
</section>
<section class="grid grid-cols-1 md:grid-cols-2 gap-10">
<div class="bg-white dark:bg-zinc-900 p-8 rounded-3xl shadow-soft border border-slate-100 dark:border-zinc-800 flex flex-col">
<div class="flex items-center gap-3 mb-6">
<div class="size-10 rounded-xl bg-primary/20 flex items-center justify-center">
<span class="material-symbols-outlined text-primary-dark">photo_camera</span>
</div>
<h3 class="text-xl font-extrabold tracking-tight">Real-time Proof</h3>
</div>
<div id="cameraSection" class="flex-1 border-2 border-dashed border-primary/40 rounded-3xl p-8 flex flex-col items-center justify-center text-center bg-primary/5 hover:bg-primary/10 hover:border-primary transition-all cursor-pointer group" onclick="openCamera()">
<div class="size-16 rounded-full bg-primary flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg">
<span class="material-symbols-outlined text-slate-900 text-3xl">photo_camera</span>
</div>
<p class="text-lg font-black text-slate-900 dark:text-white">Open Camera</p>
<p class="text-sm text-slate-500 dark:text-zinc-400 mt-2 max-w-[200px]">Real-time photos help verify reports faster</p>
</div>
<div id="photoPreview" style="display: none;" class="flex-1 rounded-3xl overflow-hidden relative">
<video id="cameraStream" class="w-full h-full object-cover rounded-3xl" autoplay playsinline></video>
<div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-3">
<button type="button" onclick="capturePhoto()" class="bg-primary text-slate-900 px-6 py-3 rounded-full font-bold shadow-lg hover:scale-105 transition">
<span class="material-symbols-outlined">photo_camera</span>
</button>
<button type="button" onclick="stopCamera()" class="bg-white/90 backdrop-blur-sm px-6 py-3 rounded-full font-bold shadow-lg hover:bg-white transition">
<span class="material-symbols-outlined text-slate-900">close</span>
</button>
</div>
</div>
<div id="capturedPreview" style="display: none;" class="flex-1 rounded-3xl overflow-hidden relative">
<img id="finalPhoto" class="w-full h-full object-cover rounded-3xl">
<button type="button" onclick="retakePhoto()" class="absolute top-4 right-4 bg-white/90 backdrop-blur-sm p-2 rounded-full shadow-lg hover:bg-white transition">
<span class="material-symbols-outlined text-slate-900">refresh</span>
</button>
</div>
<canvas id="photoCanvas" style="display: none;"></canvas>
</div>
<div class="bg-white dark:bg-zinc-900 p-8 rounded-3xl shadow-soft border border-slate-100 dark:border-zinc-800">
<div class="flex items-center gap-3 mb-6">
<div class="size-10 rounded-xl bg-primary/20 flex items-center justify-center">
<span class="material-symbols-outlined text-primary-dark">edit_note</span>
</div>
<h3 class="text-xl font-extrabold tracking-tight">Additional Details</h3>
</div>
<textarea name="description" class="w-full rounded-2xl border-slate-100 dark:border-zinc-700 bg-slate-50 dark:bg-zinc-800 focus:ring-4 focus:ring-primary/20 focus:border-primary p-5 text-base transition-all resize-none min-h-[220px]" placeholder="Explain what happened..." required></textarea>
</div>
</section>
<div class="pt-10 flex flex-col items-center gap-6">
<button onclick="submitReport()" class="w-full max-w-[500px] bg-primary text-slate-900 py-5 rounded-2xl text-xl font-black shadow-lg shadow-primary/20 hover:bg-primary-dark hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3" type="button">
<span class="material-symbols-outlined font-bold">send</span>
                Submit Report
            </button>
<div class="flex items-center gap-3 text-sm font-semibold text-primary-dark bg-primary/10 px-6 py-3 rounded-full border border-primary/20">
<span class="material-symbols-outlined text-lg">verified_user</span>
                Your identity is 100% protected and encrypted.
            </div>
</div>
</form>
<footer class="mt-32 pt-12 border-t border-slate-200 dark:border-zinc-800 flex flex-col md:flex-row justify-between items-center gap-8 opacity-70">
<div class="flex items-center gap-3">
<div class="size-2.5 bg-primary rounded-full animate-pulse"></div>
<span class="text-xs font-black uppercase tracking-[0.2em] text-slate-900 dark:text-white">CleanBite Protocol v2.0</span>
</div>
<div class="flex gap-8 text-[13px] font-bold">
<a class="hover:text-primary transition-colors" href="#">Privacy</a>
<a class="hover:text-primary transition-colors" href="#">Terms</a>
<a class="hover:text-primary transition-colors" href="#">Support</a>
</div>
<p class="text-[13px] font-medium text-slate-400">Â© 2024 CleanBite Global</p>
</footer>
</main>

<script>
let currentStream = null;

// Check camera permissions on page load
document.addEventListener('DOMContentLoaded', function() {
    // Check if camera is available
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        document.getElementById('cameraSection').innerHTML = `
            <div class="text-center">
                <span class="material-symbols-outlined text-4xl text-red-500 mb-4">no_photography</span>
                <p class="text-lg font-bold text-red-600">Camera not supported</p>
                <p class="text-sm text-slate-500">Please use a device with camera support</p>
            </div>
        `;
    }
});

async function openCamera() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ 
            video: { 
                facingMode: 'environment',
                width: { ideal: 1280 },
                height: { ideal: 720 }
            } 
        });
        
        const video = document.getElementById('cameraStream');
        video.srcObject = stream;
        window.currentStream = stream;
        
        document.getElementById('cameraSection').style.display = 'none';
        document.getElementById('photoPreview').style.display = 'block';
        
        await video.play();
    } catch (err) {
        console.error('Camera error:', err);
        let message = 'Camera access failed. ';
        if (err.name === 'NotAllowedError') {
            message += 'Please allow camera access in your browser settings.';
        } else if (err.name === 'NotFoundError') {
            message += 'No camera found on this device.';
        } else {
            message += err.message;
        }
        alert(message);
    }
}

function submitReport() {
    const vendor = document.querySelector('select[name="vendor"]').value;
    const issue = document.querySelector('input[name="issue"]:checked')?.value;
    const description = document.querySelector('textarea').value;
    
    if (!vendor || !issue || !description) {
        alert('Please fill in all required fields');
        return;
    }
    
    const button = document.querySelector('button[onclick="submitReport()"]');
    button.innerHTML = '<span class="material-symbols-outlined">check_circle</span> Report Submitted!';
    
    const currentUser = JSON.parse(localStorage.getItem('cleanbite_user'));
    
    if (currentUser) {
        const userActivities = JSON.parse(localStorage.getItem('cleanbite_user_activities') || '[]');
        userActivities.unshift({
            type: 'report',
            icon: 'report_problem',
            iconBg: 'bg-amber-100',
            iconColor: 'text-amber-700',
            title: 'Report Submitted',
            description: `${issue} - Vendor ${vendor}`,
            time: new Date().toISOString()
        });
        localStorage.setItem('cleanbite_user_activities', JSON.stringify(userActivities.slice(0, 10)));
    }
    
    const userReports = JSON.parse(localStorage.getItem('cleanbite_user_reports') || '[]');
    userReports.push({
        issueType: issue,
        vendorId: vendor,
        description: description,
        createdAt: new Date().toISOString(),
        status: 'submitted'
    });
    localStorage.setItem('cleanbite_user_reports', JSON.stringify(userReports));
    
    setTimeout(() => {
        window.location.href = 'profile.html';
    }, 1000);
}

function stopCamera() {
    if (window.currentStream) {
        window.currentStream.getTracks().forEach(track => track.stop());
        window.currentStream = null;
    }
    const video = document.getElementById('cameraStream');
    if (video.srcObject) {
        video.srcObject = null;
    }
}

function retakePhoto() {
    document.getElementById('cameraSection').style.display = 'flex';
    document.getElementById('photoPreview').style.display = 'none';
    document.getElementById('capturedPreview').style.display = 'none';
}
</script>

</body>
<script src="js/api.js"></script>
</html>

function capturePhoto() {
    const video = document.getElementById('cameraStream');
    const canvas = document.getElementById('photoCanvas');
    const ctx = canvas.getContext('2d');
    
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    ctx.drawImage(video, 0, 0);
    
    const dataURL = canvas.toDataURL('image/jpeg');
    document.getElementById('finalPhoto').src = dataURL;
    
    stopCamera();
    document.getElementById('photoPreview').style.display = 'none';
    document.getElementById('capturedPreview').style.display = 'block';
}